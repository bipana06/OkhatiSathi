/scratch/md5121/okhatisathi/tacotron2/stft.py:67: FutureWarning: Pass size=1024 as keyword args. From version 0.10 passing these as positional arguments will result in an error
  fft_window = pad_center(fft_window, filter_length)
/scratch/md5121/okhatisathi/tacotron2/layers.py:51: FutureWarning: Pass sr=22050, n_fft=1024, n_mels=80, fmin=0.0, fmax=8000.0 as keyword args. From version 0.10 passing these as positional arguments will result in an error
  sampling_rate, filter_length, n_mel_channels, mel_fmin, mel_fmax)
--- Starting W&B Run: eager-sweep-7 (ID: w4iszvto) ---
Sweep Configuration for this run:
  Overriding hparams.batch_size: 32 -> 16
  Overriding hparams.early_stopping_patience: 10 -> 8
  Overriding hparams.learning_rate: 0.0001 -> 0.0002098545455594988
  Overriding hparams.p_attention_dropout: 0.1 -> 0.05
  Overriding hparams.p_decoder_dropout: 0.1 -> 0.1
  Overriding hparams.weight_decay: 1e-06 -> 2.9428731002862625e-06
Run-specific Output Directory: ./outdir_sweep/w4iszvto
--- Final HParams for Training Run ---
  epochs: 200
  seed: 1234
  distributed_run: False
  n_gpus: 1
  rank: 0
  group_name: group_name
  cudnn_enabled: True
  cudnn_benchmark: False
  fp16_run: False
  load_mel_from_disk: False
  training_files: ./filelists/train_list.txt
  validation_files: ./filelists/val_list.txt
  text_cleaners: ['transliteration_cleaners']
  num_workers: 4
  pin_memory: True
  max_wav_value: 32768.0
  sampling_rate: 22050
  filter_length: 1024
  hop_length: 256
  win_length: 1024
  n_mel_channels: 80
  mel_fmin: 0.0
  mel_fmax: 8000.0
  n_symbols: 148
  symbols_embedding_dim: 512
  encoder_kernel_size: 5
  encoder_n_convolutions: 3
  encoder_embedding_dim: 512
  n_frames_per_step: 1
  decoder_rnn_dim: 1024
  prenet_dim: 256
  max_decoder_steps: 1000
  gate_threshold: 0.5
  p_attention_dropout: 0.05
  p_decoder_dropout: 0.1
  attention_rnn_dim: 1024
  attention_dim: 128
  attention_location_n_filters: 32
  attention_location_kernel_size: 31
  postnet_embedding_dim: 512
  postnet_kernel_size: 5
  postnet_n_convolutions: 5
  use_saved_learning_rate: False
  learning_rate: 0.0002098545455594988
  weight_decay: 2.9428731002862625e-06
  grad_clip_thresh: 1.0
  batch_size: 16
  mask_padding: True
  log_interval: 100
  iters_per_checkpoint: 1000
  early_stopping_patience: 8
  min_val_loss_delta: 0.0001
  ignore_layers: ['embedding.weight']
--------------------------------------
Calling train function...
TensorBoard Log directory: ./outdir_sweep/w4iszvto/logs
Warm starting model from checkpoint 'tacotron2_statedict.pt'
  Applying warm start: Ignored 1 keys based on ignore_layers. Loading 83 keys.
Warm start complete. Optimizer and iteration count reset.
Starting training for 200 epochs...
--- Epoch: 0 ---
Train Iter: 0 Epoch: 0 [0/2367 (0%)]	Loss: 1.528088	Grad Norm: 12.123345	LR: 2.1E-04	Time: 6.26s/it
Train Iter: 100 Epoch: 0 [1600/2367 (68%)]	Loss: 0.523610	Grad Norm: 1.727379	LR: 2.1E-04	Time: 4.49s/it
--- Epoch 0 Summary ---
Average Training Loss: 0.667094
Average Grad Norm: 2.097993
Epoch Duration: 639.28s
--- Running Validation at Iteration 147 ---
Validation Loss: 0.488893 (Duration: 22.56s)
Saving model and optimizer state at iteration 147 to ./outdir_sweep/w4iszvto/checkpoint_147
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_147
Checking Early Stopping: Current Best Loss = inf, New Loss = 0.488893
Saving model and optimizer state at iteration 147 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_147_loss_0.4889.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_147_loss_0.4889.pt
  Validation loss improved! New best: 0.488893. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_147_loss_0.4889.pt
--- Validation Complete ---
--- Epoch: 1 ---
Train Iter: 200 Epoch: 1 [848/2367 (36%)]	Loss: 0.513533	Grad Norm: 1.052427	LR: 2.1E-04	Time: 3.67s/it
--- Epoch 1 Summary ---
Average Training Loss: 0.528841
Average Grad Norm: 1.147639
Epoch Duration: 635.90s
--- Running Validation at Iteration 294 ---
Validation Loss: 0.446798 (Duration: 22.53s)
Saving model and optimizer state at iteration 294 to ./outdir_sweep/w4iszvto/checkpoint_294
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_294
Checking Early Stopping: Current Best Loss = 0.488893, New Loss = 0.446798
Saving model and optimizer state at iteration 294 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_294_loss_0.4468.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_294_loss_0.4468.pt
  Validation loss improved! New best: 0.446798. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_294_loss_0.4468.pt
--- Validation Complete ---
--- Epoch: 2 ---
Train Iter: 300 Epoch: 2 [96/2367 (4%)]	Loss: 0.561333	Grad Norm: 0.651122	LR: 2.1E-04	Time: 4.82s/it
Train Iter: 400 Epoch: 2 [1696/2367 (72%)]	Loss: 0.549207	Grad Norm: 2.179100	LR: 2.1E-04	Time: 4.47s/it
--- Epoch 2 Summary ---
Average Training Loss: 0.496774
Average Grad Norm: 1.056034
Epoch Duration: 636.32s
--- Running Validation at Iteration 441 ---
Validation Loss: 0.436248 (Duration: 22.67s)
Saving model and optimizer state at iteration 441 to ./outdir_sweep/w4iszvto/checkpoint_441
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_441
Checking Early Stopping: Current Best Loss = 0.446798, New Loss = 0.436248
Saving model and optimizer state at iteration 441 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_441_loss_0.4362.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_441_loss_0.4362.pt
  Validation loss improved! New best: 0.436248. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_441_loss_0.4362.pt
--- Validation Complete ---
--- Epoch: 3 ---
Train Iter: 500 Epoch: 3 [944/2367 (40%)]	Loss: 0.516473	Grad Norm: 0.589412	LR: 2.1E-04	Time: 3.69s/it
--- Epoch 3 Summary ---
Average Training Loss: 0.469265
Average Grad Norm: 1.059130
Epoch Duration: 649.46s
--- Running Validation at Iteration 588 ---
Validation Loss: 0.420543 (Duration: 22.50s)
Saving model and optimizer state at iteration 588 to ./outdir_sweep/w4iszvto/checkpoint_588
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_588
Checking Early Stopping: Current Best Loss = 0.436248, New Loss = 0.420543
Saving model and optimizer state at iteration 588 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_588_loss_0.4205.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_588_loss_0.4205.pt
  Validation loss improved! New best: 0.420543. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_588_loss_0.4205.pt
--- Validation Complete ---
--- Epoch: 4 ---
Train Iter: 600 Epoch: 4 [192/2367 (8%)]	Loss: 0.368907	Grad Norm: 0.881885	LR: 2.1E-04	Time: 5.03s/it
Train Iter: 700 Epoch: 4 [1792/2367 (76%)]	Loss: 0.397900	Grad Norm: 0.679250	LR: 2.1E-04	Time: 4.85s/it
--- Epoch 4 Summary ---
Average Training Loss: 0.463611
Average Grad Norm: 0.987306
Epoch Duration: 636.77s
--- Running Validation at Iteration 735 ---
Validation Loss: 0.403762 (Duration: 22.49s)
Saving model and optimizer state at iteration 735 to ./outdir_sweep/w4iszvto/checkpoint_735
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_735
Checking Early Stopping: Current Best Loss = 0.420543, New Loss = 0.403762
Saving model and optimizer state at iteration 735 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_735_loss_0.4038.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_735_loss_0.4038.pt
  Validation loss improved! New best: 0.403762. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_735_loss_0.4038.pt
--- Validation Complete ---
--- Epoch: 5 ---
Train Iter: 800 Epoch: 5 [1040/2367 (44%)]	Loss: 0.468047	Grad Norm: 0.449974	LR: 2.1E-04	Time: 4.53s/it
--- Epoch 5 Summary ---
Average Training Loss: 0.441431
Average Grad Norm: 0.821231
Epoch Duration: 645.65s
--- Running Validation at Iteration 882 ---
Validation Loss: 0.389554 (Duration: 22.79s)
Saving model and optimizer state at iteration 882 to ./outdir_sweep/w4iszvto/checkpoint_882
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_882
Checking Early Stopping: Current Best Loss = 0.403762, New Loss = 0.389554
Saving model and optimizer state at iteration 882 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_882_loss_0.3896.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_882_loss_0.3896.pt
  Validation loss improved! New best: 0.389554. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_882_loss_0.3896.pt
--- Validation Complete ---
--- Epoch: 6 ---
Train Iter: 900 Epoch: 6 [288/2367 (12%)]	Loss: 0.426592	Grad Norm: 0.726362	LR: 2.1E-04	Time: 4.57s/it
Train Iter: 1000 Epoch: 6 [1888/2367 (80%)]	Loss: 0.407776	Grad Norm: 1.426074	LR: 2.1E-04	Time: 5.74s/it
--- Epoch 6 Summary ---
Average Training Loss: 0.428679
Average Grad Norm: 0.846770
Epoch Duration: 639.44s
--- Running Validation at Iteration 1029 ---
Validation Loss: 0.384912 (Duration: 22.74s)
Saving model and optimizer state at iteration 1029 to ./outdir_sweep/w4iszvto/checkpoint_1029
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1029
Checking Early Stopping: Current Best Loss = 0.389554, New Loss = 0.384912
Saving model and optimizer state at iteration 1029 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_1029_loss_0.3849.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1029_loss_0.3849.pt
  Validation loss improved! New best: 0.384912. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1029_loss_0.3849.pt
--- Validation Complete ---
--- Epoch: 7 ---
Train Iter: 1100 Epoch: 7 [1136/2367 (48%)]	Loss: 0.431991	Grad Norm: 0.428397	LR: 2.1E-04	Time: 4.40s/it
--- Epoch 7 Summary ---
Average Training Loss: 0.419271
Average Grad Norm: 0.847431
Epoch Duration: 638.92s
--- Running Validation at Iteration 1176 ---
Validation Loss: 0.375103 (Duration: 22.57s)
Saving model and optimizer state at iteration 1176 to ./outdir_sweep/w4iszvto/checkpoint_1176
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1176
Checking Early Stopping: Current Best Loss = 0.384912, New Loss = 0.375103
Saving model and optimizer state at iteration 1176 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_1176_loss_0.3751.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1176_loss_0.3751.pt
  Validation loss improved! New best: 0.375103. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1176_loss_0.3751.pt
--- Validation Complete ---
--- Epoch: 8 ---
Train Iter: 1200 Epoch: 8 [384/2367 (16%)]	Loss: 0.465208	Grad Norm: 0.499588	LR: 2.1E-04	Time: 4.08s/it
Train Iter: 1300 Epoch: 8 [1984/2367 (84%)]	Loss: 0.406982	Grad Norm: 0.866476	LR: 2.1E-04	Time: 4.37s/it
--- Epoch 8 Summary ---
Average Training Loss: 0.404341
Average Grad Norm: 0.781821
Epoch Duration: 651.10s
--- Running Validation at Iteration 1323 ---
Validation Loss: 0.372947 (Duration: 22.59s)
Saving model and optimizer state at iteration 1323 to ./outdir_sweep/w4iszvto/checkpoint_1323
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1323
Checking Early Stopping: Current Best Loss = 0.375103, New Loss = 0.372947
Saving model and optimizer state at iteration 1323 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_1323_loss_0.3729.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1323_loss_0.3729.pt
  Validation loss improved! New best: 0.372947. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1323_loss_0.3729.pt
--- Validation Complete ---
--- Epoch: 9 ---
Train Iter: 1400 Epoch: 9 [1232/2367 (52%)]	Loss: 0.443896	Grad Norm: 0.988359	LR: 2.1E-04	Time: 3.48s/it
--- Epoch 9 Summary ---
Average Training Loss: 0.399276
Average Grad Norm: 0.738976
Epoch Duration: 645.57s
--- Running Validation at Iteration 1470 ---
Validation Loss: 0.367331 (Duration: 22.67s)
Saving model and optimizer state at iteration 1470 to ./outdir_sweep/w4iszvto/checkpoint_1470
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1470
Checking Early Stopping: Current Best Loss = 0.372947, New Loss = 0.367331
Saving model and optimizer state at iteration 1470 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_1470_loss_0.3673.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1470_loss_0.3673.pt
  Validation loss improved! New best: 0.367331. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1470_loss_0.3673.pt
--- Validation Complete ---
--- Epoch: 10 ---
Train Iter: 1500 Epoch: 10 [480/2367 (20%)]	Loss: 0.355234	Grad Norm: 0.718695	LR: 2.1E-04	Time: 4.76s/it
Train Iter: 1600 Epoch: 10 [2080/2367 (88%)]	Loss: 0.356731	Grad Norm: 0.715783	LR: 2.1E-04	Time: 3.89s/it
--- Epoch 10 Summary ---
Average Training Loss: 0.399531
Average Grad Norm: 0.821196
Epoch Duration: 636.28s
--- Running Validation at Iteration 1617 ---
Validation Loss: 0.368872 (Duration: 22.64s)
Saving model and optimizer state at iteration 1617 to ./outdir_sweep/w4iszvto/checkpoint_1617
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1617
Checking Early Stopping: Current Best Loss = 0.367331, New Loss = 0.368872
  Validation loss did not improve significantly (1/8).
--- Validation Complete ---
--- Epoch: 11 ---
Train Iter: 1700 Epoch: 11 [1328/2367 (56%)]	Loss: 0.302330	Grad Norm: 0.561360	LR: 2.1E-04	Time: 5.15s/it
--- Epoch 11 Summary ---
Average Training Loss: 0.397183
Average Grad Norm: 0.819704
Epoch Duration: 633.68s
--- Running Validation at Iteration 1764 ---
Validation Loss: 0.364912 (Duration: 22.49s)
Saving model and optimizer state at iteration 1764 to ./outdir_sweep/w4iszvto/checkpoint_1764
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1764
Checking Early Stopping: Current Best Loss = 0.367331, New Loss = 0.364912
Saving model and optimizer state at iteration 1764 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_1764_loss_0.3649.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1764_loss_0.3649.pt
  Validation loss improved! New best: 0.364912. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1764_loss_0.3649.pt
--- Validation Complete ---
--- Epoch: 12 ---
Train Iter: 1800 Epoch: 12 [576/2367 (24%)]	Loss: 0.342645	Grad Norm: 0.716025	LR: 2.1E-04	Time: 5.57s/it
Train Iter: 1900 Epoch: 12 [2176/2367 (93%)]	Loss: 0.362670	Grad Norm: 0.627653	LR: 2.1E-04	Time: 4.96s/it
--- Epoch 12 Summary ---
Average Training Loss: 0.382733
Average Grad Norm: 0.746676
Epoch Duration: 644.96s
--- Running Validation at Iteration 1911 ---
Validation Loss: 0.361181 (Duration: 22.55s)
Saving model and optimizer state at iteration 1911 to ./outdir_sweep/w4iszvto/checkpoint_1911
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_1911
Checking Early Stopping: Current Best Loss = 0.364912, New Loss = 0.361181
Saving model and optimizer state at iteration 1911 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_1911_loss_0.3612.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1911_loss_0.3612.pt
  Validation loss improved! New best: 0.361181. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_1911_loss_0.3612.pt
--- Validation Complete ---
--- Epoch: 13 ---
Train Iter: 2000 Epoch: 13 [1424/2367 (61%)]	Loss: 0.335330	Grad Norm: 0.451628	LR: 2.1E-04	Time: 4.26s/it
--- Epoch 13 Summary ---
Average Training Loss: 0.380469
Average Grad Norm: 0.660565
Epoch Duration: 642.60s
--- Running Validation at Iteration 2058 ---
Validation Loss: 0.361478 (Duration: 22.70s)
Saving model and optimizer state at iteration 2058 to ./outdir_sweep/w4iszvto/checkpoint_2058
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2058
Checking Early Stopping: Current Best Loss = 0.361181, New Loss = 0.361478
  Validation loss did not improve significantly (1/8).
--- Validation Complete ---
--- Epoch: 14 ---
Train Iter: 2100 Epoch: 14 [672/2367 (29%)]	Loss: 0.372384	Grad Norm: 0.524522	LR: 2.1E-04	Time: 4.96s/it
Train Iter: 2200 Epoch: 14 [2272/2367 (97%)]	Loss: 0.419713	Grad Norm: 0.562938	LR: 2.1E-04	Time: 3.82s/it
--- Epoch 14 Summary ---
Average Training Loss: 0.379052
Average Grad Norm: 0.676814
Epoch Duration: 634.76s
--- Running Validation at Iteration 2205 ---
Validation Loss: 0.360482 (Duration: 22.58s)
Saving model and optimizer state at iteration 2205 to ./outdir_sweep/w4iszvto/checkpoint_2205
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2205
Checking Early Stopping: Current Best Loss = 0.361181, New Loss = 0.360482
Saving model and optimizer state at iteration 2205 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_2205_loss_0.3605.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_2205_loss_0.3605.pt
  Validation loss improved! New best: 0.360482. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_2205_loss_0.3605.pt
--- Validation Complete ---
--- Epoch: 15 ---
Train Iter: 2300 Epoch: 15 [1520/2367 (65%)]	Loss: 0.446802	Grad Norm: 0.463183	LR: 2.1E-04	Time: 3.42s/it
--- Epoch 15 Summary ---
Average Training Loss: 0.371571
Average Grad Norm: 0.688040
Epoch Duration: 644.56s
--- Running Validation at Iteration 2352 ---
Validation Loss: 0.358548 (Duration: 22.59s)
Saving model and optimizer state at iteration 2352 to ./outdir_sweep/w4iszvto/checkpoint_2352
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2352
Checking Early Stopping: Current Best Loss = 0.360482, New Loss = 0.358548
Saving model and optimizer state at iteration 2352 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_2352_loss_0.3585.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_2352_loss_0.3585.pt
  Validation loss improved! New best: 0.358548. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_2352_loss_0.3585.pt
--- Validation Complete ---
--- Epoch: 16 ---
Train Iter: 2400 Epoch: 16 [768/2367 (33%)]	Loss: 0.416054	Grad Norm: 0.762183	LR: 2.1E-04	Time: 5.00s/it
--- Epoch 16 Summary ---
Average Training Loss: 0.371117
Average Grad Norm: 0.695778
Epoch Duration: 634.75s
--- Running Validation at Iteration 2499 ---
Validation Loss: 0.359534 (Duration: 22.67s)
Saving model and optimizer state at iteration 2499 to ./outdir_sweep/w4iszvto/checkpoint_2499
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2499
Checking Early Stopping: Current Best Loss = 0.358548, New Loss = 0.359534
  Validation loss did not improve significantly (1/8).
--- Validation Complete ---
--- Epoch: 17 ---
Train Iter: 2500 Epoch: 17 [16/2367 (1%)]	Loss: 0.309970	Grad Norm: 0.429204	LR: 2.1E-04	Time: 4.88s/it
Train Iter: 2600 Epoch: 17 [1616/2367 (69%)]	Loss: 0.381835	Grad Norm: 0.556930	LR: 2.1E-04	Time: 4.29s/it
--- Epoch 17 Summary ---
Average Training Loss: 0.360389
Average Grad Norm: 0.616718
Epoch Duration: 647.45s
--- Running Validation at Iteration 2646 ---
Validation Loss: 0.359197 (Duration: 22.54s)
Saving model and optimizer state at iteration 2646 to ./outdir_sweep/w4iszvto/checkpoint_2646
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2646
Checking Early Stopping: Current Best Loss = 0.358548, New Loss = 0.359197
  Validation loss did not improve significantly (2/8).
--- Validation Complete ---
--- Epoch: 18 ---
Train Iter: 2700 Epoch: 18 [864/2367 (37%)]	Loss: 0.428470	Grad Norm: 0.597163	LR: 2.1E-04	Time: 4.20s/it
--- Epoch 18 Summary ---
Average Training Loss: 0.362319
Average Grad Norm: 0.757249
Epoch Duration: 637.99s
--- Running Validation at Iteration 2793 ---
Validation Loss: 0.356904 (Duration: 22.74s)
Saving model and optimizer state at iteration 2793 to ./outdir_sweep/w4iszvto/checkpoint_2793
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2793
Checking Early Stopping: Current Best Loss = 0.358548, New Loss = 0.356904
Saving model and optimizer state at iteration 2793 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_2793_loss_0.3569.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_2793_loss_0.3569.pt
  Validation loss improved! New best: 0.356904. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_2793_loss_0.3569.pt
--- Validation Complete ---
--- Epoch: 19 ---
Train Iter: 2800 Epoch: 19 [112/2367 (5%)]	Loss: 0.369692	Grad Norm: 0.338632	LR: 2.1E-04	Time: 3.68s/it
Train Iter: 2900 Epoch: 19 [1712/2367 (73%)]	Loss: 0.374947	Grad Norm: 0.884439	LR: 2.1E-04	Time: 4.98s/it
--- Epoch 19 Summary ---
Average Training Loss: 0.353168
Average Grad Norm: 0.586725
Epoch Duration: 644.95s
--- Running Validation at Iteration 2940 ---
Validation Loss: 0.357171 (Duration: 22.62s)
Saving model and optimizer state at iteration 2940 to ./outdir_sweep/w4iszvto/checkpoint_2940
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_2940
Checking Early Stopping: Current Best Loss = 0.356904, New Loss = 0.357171
  Validation loss did not improve significantly (1/8).
--- Validation Complete ---
--- Epoch: 20 ---
Train Iter: 3000 Epoch: 20 [960/2367 (41%)]	Loss: 0.429404	Grad Norm: 0.611718	LR: 2.1E-04	Time: 3.50s/it
--- Epoch 20 Summary ---
Average Training Loss: 0.354864
Average Grad Norm: 0.634645
Epoch Duration: 640.59s
--- Running Validation at Iteration 3087 ---
Validation Loss: 0.355946 (Duration: 22.62s)
Saving model and optimizer state at iteration 3087 to ./outdir_sweep/w4iszvto/checkpoint_3087
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3087
Checking Early Stopping: Current Best Loss = 0.356904, New Loss = 0.355946
Saving model and optimizer state at iteration 3087 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_3087_loss_0.3559.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_3087_loss_0.3559.pt
  Validation loss improved! New best: 0.355946. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_3087_loss_0.3559.pt
--- Validation Complete ---
--- Epoch: 21 ---
Train Iter: 3100 Epoch: 21 [208/2367 (9%)]	Loss: 0.437198	Grad Norm: 1.036845	LR: 2.1E-04	Time: 3.30s/it
Train Iter: 3200 Epoch: 21 [1808/2367 (77%)]	Loss: 0.368349	Grad Norm: 0.457863	LR: 2.1E-04	Time: 3.59s/it
--- Epoch 21 Summary ---
Average Training Loss: 0.349606
Average Grad Norm: 0.541657
Epoch Duration: 641.68s
--- Running Validation at Iteration 3234 ---
Validation Loss: 0.353401 (Duration: 22.56s)
Saving model and optimizer state at iteration 3234 to ./outdir_sweep/w4iszvto/checkpoint_3234
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3234
Checking Early Stopping: Current Best Loss = 0.355946, New Loss = 0.353401
Saving model and optimizer state at iteration 3234 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_3234_loss_0.3534.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_3234_loss_0.3534.pt
  Validation loss improved! New best: 0.353401. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_3234_loss_0.3534.pt
--- Validation Complete ---
--- Epoch: 22 ---
Train Iter: 3300 Epoch: 22 [1056/2367 (45%)]	Loss: 0.368335	Grad Norm: 1.315255	LR: 2.1E-04	Time: 4.49s/it
--- Epoch 22 Summary ---
Average Training Loss: 0.348250
Average Grad Norm: 0.638107
Epoch Duration: 640.39s
--- Running Validation at Iteration 3381 ---
Validation Loss: 0.353133 (Duration: 22.63s)
Saving model and optimizer state at iteration 3381 to ./outdir_sweep/w4iszvto/checkpoint_3381
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3381
Checking Early Stopping: Current Best Loss = 0.353401, New Loss = 0.353133
Saving model and optimizer state at iteration 3381 to ./outdir_sweep/w4iszvto/checkpoint_best_iter_3381_loss_0.3531.pt
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_best_iter_3381_loss_0.3531.pt
  Validation loss improved! New best: 0.353133. Saved best model: ./outdir_sweep/w4iszvto/checkpoint_best_iter_3381_loss_0.3531.pt
--- Validation Complete ---
--- Epoch: 23 ---
Train Iter: 3400 Epoch: 23 [304/2367 (13%)]	Loss: 0.291758	Grad Norm: 0.552400	LR: 2.1E-04	Time: 5.17s/it
Train Iter: 3500 Epoch: 23 [1904/2367 (81%)]	Loss: 0.341617	Grad Norm: 0.689790	LR: 2.1E-04	Time: 4.64s/it
--- Epoch 23 Summary ---
Average Training Loss: 0.345164
Average Grad Norm: 0.633193
Epoch Duration: 640.53s
--- Running Validation at Iteration 3528 ---
Validation Loss: 0.353798 (Duration: 22.49s)
Saving model and optimizer state at iteration 3528 to ./outdir_sweep/w4iszvto/checkpoint_3528
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3528
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.353798
  Validation loss did not improve significantly (1/8).
--- Validation Complete ---
--- Epoch: 24 ---
Train Iter: 3600 Epoch: 24 [1152/2367 (49%)]	Loss: 0.319332	Grad Norm: 0.298457	LR: 2.1E-04	Time: 4.19s/it
--- Epoch 24 Summary ---
Average Training Loss: 0.337213
Average Grad Norm: 0.572720
Epoch Duration: 649.86s
--- Running Validation at Iteration 3675 ---
Validation Loss: 0.355153 (Duration: 22.57s)
Saving model and optimizer state at iteration 3675 to ./outdir_sweep/w4iszvto/checkpoint_3675
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3675
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.355153
  Validation loss did not improve significantly (2/8).
--- Validation Complete ---
--- Epoch: 25 ---
Train Iter: 3700 Epoch: 25 [400/2367 (17%)]	Loss: 0.354338	Grad Norm: 0.384450	LR: 2.1E-04	Time: 3.99s/it
Train Iter: 3800 Epoch: 25 [2000/2367 (85%)]	Loss: 0.354032	Grad Norm: 0.607051	LR: 2.1E-04	Time: 4.50s/it
--- Epoch 25 Summary ---
Average Training Loss: 0.342967
Average Grad Norm: 0.484174
Epoch Duration: 637.17s
--- Running Validation at Iteration 3822 ---
Validation Loss: 0.354549 (Duration: 22.56s)
Saving model and optimizer state at iteration 3822 to ./outdir_sweep/w4iszvto/checkpoint_3822
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3822
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.354549
  Validation loss did not improve significantly (3/8).
--- Validation Complete ---
--- Epoch: 26 ---
Train Iter: 3900 Epoch: 26 [1248/2367 (53%)]	Loss: 0.398061	Grad Norm: 0.491163	LR: 2.1E-04	Time: 2.97s/it
--- Epoch 26 Summary ---
Average Training Loss: 0.338277
Average Grad Norm: 0.589179
Epoch Duration: 642.21s
--- Running Validation at Iteration 3969 ---
Validation Loss: 0.354912 (Duration: 22.54s)
Saving model and optimizer state at iteration 3969 to ./outdir_sweep/w4iszvto/checkpoint_3969
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_3969
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.354912
  Validation loss did not improve significantly (4/8).
--- Validation Complete ---
--- Epoch: 27 ---
Train Iter: 4000 Epoch: 27 [496/2367 (21%)]	Loss: 0.326483	Grad Norm: 0.916755	LR: 2.1E-04	Time: 4.85s/it
Train Iter: 4100 Epoch: 27 [2096/2367 (89%)]	Loss: 0.370385	Grad Norm: 0.336742	LR: 2.1E-04	Time: 3.53s/it
--- Epoch 27 Summary ---
Average Training Loss: 0.338548
Average Grad Norm: 0.477431
Epoch Duration: 634.45s
--- Running Validation at Iteration 4116 ---
Validation Loss: 0.354097 (Duration: 22.61s)
Saving model and optimizer state at iteration 4116 to ./outdir_sweep/w4iszvto/checkpoint_4116
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_4116
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.354097
  Validation loss did not improve significantly (5/8).
--- Validation Complete ---
--- Epoch: 28 ---
Train Iter: 4200 Epoch: 28 [1344/2367 (57%)]	Loss: 0.346980	Grad Norm: 0.657661	LR: 2.1E-04	Time: 3.98s/it
--- Epoch 28 Summary ---
Average Training Loss: 0.332212
Average Grad Norm: 0.502324
Epoch Duration: 642.03s
--- Running Validation at Iteration 4263 ---
Validation Loss: 0.355097 (Duration: 22.53s)
Saving model and optimizer state at iteration 4263 to ./outdir_sweep/w4iszvto/checkpoint_4263
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_4263
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.355097
  Validation loss did not improve significantly (6/8).
--- Validation Complete ---
--- Epoch: 29 ---
Train Iter: 4300 Epoch: 29 [592/2367 (25%)]	Loss: 0.300070	Grad Norm: 0.533244	LR: 2.1E-04	Time: 5.00s/it
Train Iter: 4400 Epoch: 29 [2192/2367 (93%)]	Loss: 0.325620	Grad Norm: 0.341233	LR: 2.1E-04	Time: 4.76s/it
--- Epoch 29 Summary ---
Average Training Loss: 0.329085
Average Grad Norm: 0.538884
Epoch Duration: 644.76s
--- Running Validation at Iteration 4410 ---
Validation Loss: 0.354086 (Duration: 22.49s)
Saving model and optimizer state at iteration 4410 to ./outdir_sweep/w4iszvto/checkpoint_4410
Checkpoint saved: ./outdir_sweep/w4iszvto/checkpoint_4410
Checking Early Stopping: Current Best Loss = 0.353133, New Loss = 0.354086
  Validation loss did not improve significantly (7/8).
--- Validation Complete ---
--- Epoch: 30 ---
Train Iter: 4500 Epoch: 30 [1440/2367 (61%)]	Loss: 0.347057	Grad Norm: 0.489410	LR: 2.1E-04	Time: 4.29s/it
--- Epoch 30 Summary ---
Average Training Loss: 0.327424
Average Grad Norm: 0.539525
Epoch Duration: 642.72s
--- Running Validation at Iteration 4557 ---