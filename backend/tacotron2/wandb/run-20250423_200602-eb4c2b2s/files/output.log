/scratch/md5121/okhatisathi/tacotron2/stft.py:67: FutureWarning: Pass size=1024 as keyword args. From version 0.10 passing these as positional arguments will result in an error
  fft_window = pad_center(fft_window, filter_length)
/scratch/md5121/okhatisathi/tacotron2/layers.py:51: FutureWarning: Pass sr=22050, n_fft=1024, n_mels=80, fmin=0.0, fmax=8000.0 as keyword args. From version 0.10 passing these as positional arguments will result in an error
  sampling_rate, filter_length, n_mel_channels, mel_fmin, mel_fmax)
--- Starting W&B Run: devoted-sweep-28 (ID: eb4c2b2s) ---
Sweep Configuration for this run:
  Overriding hparams.batch_size: 32 -> 16
  Overriding hparams.early_stopping_patience: 10 -> 10
  Overriding hparams.learning_rate: 0.0001 -> 5.858324463758867e-05
  Overriding hparams.p_attention_dropout: 0.1 -> 0.15
  Overriding hparams.p_decoder_dropout: 0.1 -> 0.05
  Overriding hparams.weight_decay: 1e-06 -> 1.856504118036292e-06
Run-specific Output Directory: ./outdir_sweep/eb4c2b2s
--- Final HParams for Training Run ---
  epochs: 200
  seed: 1234
  distributed_run: False
  n_gpus: 1
  rank: 0
  group_name: group_name
  cudnn_enabled: True
  cudnn_benchmark: False
  fp16_run: False
  load_mel_from_disk: False
  training_files: ./filelists/train_list.txt
  validation_files: ./filelists/val_list.txt
  text_cleaners: ['transliteration_cleaners']
  num_workers: 4
  pin_memory: True
  max_wav_value: 32768.0
  sampling_rate: 22050
  filter_length: 1024
  hop_length: 256
  win_length: 1024
  n_mel_channels: 80
  mel_fmin: 0.0
  mel_fmax: 8000.0
  n_symbols: 148
  symbols_embedding_dim: 512
  encoder_kernel_size: 5
  encoder_n_convolutions: 3
  encoder_embedding_dim: 512
  n_frames_per_step: 1
  decoder_rnn_dim: 1024
  prenet_dim: 256
  max_decoder_steps: 1000
  gate_threshold: 0.5
  p_attention_dropout: 0.15
  p_decoder_dropout: 0.05
  attention_rnn_dim: 1024
  attention_dim: 128
  attention_location_n_filters: 32
  attention_location_kernel_size: 31
  postnet_embedding_dim: 512
  postnet_kernel_size: 5
  postnet_n_convolutions: 5
  use_saved_learning_rate: False
  learning_rate: 5.858324463758867e-05
  weight_decay: 1.856504118036292e-06
  grad_clip_thresh: 1.0
  batch_size: 16
  mask_padding: True
  log_interval: 100
  iters_per_checkpoint: 1000
  early_stopping_patience: 10
  min_val_loss_delta: 0.0001
  ignore_layers: ['embedding.weight']
--------------------------------------
Calling train function...
TensorBoard Log directory: ./outdir_sweep/eb4c2b2s/logs
Warm starting model from checkpoint 'tacotron2_statedict.pt'
  Applying warm start: Ignored 1 keys based on ignore_layers. Loading 83 keys.
Warm start complete. Optimizer and iteration count reset.
Starting training for 200 epochs...
--- Epoch: 0 ---
Train Iter: 0 Epoch: 0 [0/2367 (0%)]	Loss: 1.549023	Grad Norm: 11.333547	LR: 5.9E-05	Time: 6.19s/it
Train Iter: 100 Epoch: 0 [1600/2367 (68%)]	Loss: 0.567725	Grad Norm: 0.594348	LR: 5.9E-05	Time: 4.47s/it
--- Epoch 0 Summary ---
Average Training Loss: 0.740755
Average Grad Norm: 2.170633
Epoch Duration: 636.50s
--- Running Validation at Iteration 147 ---
Validation Loss: 0.545196 (Duration: 22.58s)
Saving model and optimizer state at iteration 147 to ./outdir_sweep/eb4c2b2s/checkpoint_147
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_147
Checking Early Stopping: Current Best Loss = inf, New Loss = 0.545196
Saving model and optimizer state at iteration 147 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_147_loss_0.5452.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_147_loss_0.5452.pt
  Validation loss improved! New best: 0.545196. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_147_loss_0.5452.pt
--- Validation Complete ---
--- Epoch: 1 ---
Train Iter: 200 Epoch: 1 [848/2367 (36%)]	Loss: 0.560642	Grad Norm: 0.897424	LR: 5.9E-05	Time: 3.66s/it
--- Epoch 1 Summary ---
Average Training Loss: 0.586327
Average Grad Norm: 1.141611
Epoch Duration: 634.25s
--- Running Validation at Iteration 294 ---
Validation Loss: 0.505322 (Duration: 22.58s)
Saving model and optimizer state at iteration 294 to ./outdir_sweep/eb4c2b2s/checkpoint_294
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_294
Checking Early Stopping: Current Best Loss = 0.545196, New Loss = 0.505322
Saving model and optimizer state at iteration 294 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_294_loss_0.5053.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_294_loss_0.5053.pt
  Validation loss improved! New best: 0.505322. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_294_loss_0.5053.pt
--- Validation Complete ---
--- Epoch: 2 ---
Train Iter: 300 Epoch: 2 [96/2367 (4%)]	Loss: 0.630016	Grad Norm: 0.964649	LR: 5.9E-05	Time: 4.82s/it
Train Iter: 400 Epoch: 2 [1696/2367 (72%)]	Loss: 0.595397	Grad Norm: 1.297181	LR: 5.9E-05	Time: 4.45s/it
--- Epoch 2 Summary ---
Average Training Loss: 0.554098
Average Grad Norm: 1.032426
Epoch Duration: 637.23s
--- Running Validation at Iteration 441 ---
Validation Loss: 0.487349 (Duration: 22.59s)
Saving model and optimizer state at iteration 441 to ./outdir_sweep/eb4c2b2s/checkpoint_441
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_441
Checking Early Stopping: Current Best Loss = 0.505322, New Loss = 0.487349
Saving model and optimizer state at iteration 441 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_441_loss_0.4873.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_441_loss_0.4873.pt
  Validation loss improved! New best: 0.487349. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_441_loss_0.4873.pt
--- Validation Complete ---
--- Epoch: 3 ---
Train Iter: 500 Epoch: 3 [944/2367 (40%)]	Loss: 0.588891	Grad Norm: 0.622156	LR: 5.9E-05	Time: 3.69s/it
--- Epoch 3 Summary ---
Average Training Loss: 0.524221
Average Grad Norm: 0.954583
Epoch Duration: 650.89s
--- Running Validation at Iteration 588 ---
Validation Loss: 0.468178 (Duration: 22.50s)
Saving model and optimizer state at iteration 588 to ./outdir_sweep/eb4c2b2s/checkpoint_588
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_588
Checking Early Stopping: Current Best Loss = 0.487349, New Loss = 0.468178
Saving model and optimizer state at iteration 588 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_588_loss_0.4682.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_588_loss_0.4682.pt
  Validation loss improved! New best: 0.468178. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_588_loss_0.4682.pt
--- Validation Complete ---
--- Epoch: 4 ---
Train Iter: 600 Epoch: 4 [192/2367 (8%)]	Loss: 0.407384	Grad Norm: 0.826929	LR: 5.9E-05	Time: 5.15s/it
Train Iter: 700 Epoch: 4 [1792/2367 (76%)]	Loss: 0.442970	Grad Norm: 0.577699	LR: 5.9E-05	Time: 4.83s/it
--- Epoch 4 Summary ---
Average Training Loss: 0.522031
Average Grad Norm: 0.833959
Epoch Duration: 635.67s
--- Running Validation at Iteration 735 ---
Validation Loss: 0.454980 (Duration: 22.58s)
Saving model and optimizer state at iteration 735 to ./outdir_sweep/eb4c2b2s/checkpoint_735
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_735
Checking Early Stopping: Current Best Loss = 0.468178, New Loss = 0.454980
Saving model and optimizer state at iteration 735 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_735_loss_0.4550.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_735_loss_0.4550.pt
  Validation loss improved! New best: 0.454980. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_735_loss_0.4550.pt
--- Validation Complete ---
--- Epoch: 5 ---
Train Iter: 800 Epoch: 5 [1040/2367 (44%)]	Loss: 0.532527	Grad Norm: 1.287025	LR: 5.9E-05	Time: 4.52s/it
--- Epoch 5 Summary ---
Average Training Loss: 0.504430
Average Grad Norm: 0.883165
Epoch Duration: 643.54s
--- Running Validation at Iteration 882 ---
Validation Loss: 0.445921 (Duration: 22.62s)
Saving model and optimizer state at iteration 882 to ./outdir_sweep/eb4c2b2s/checkpoint_882
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_882
Checking Early Stopping: Current Best Loss = 0.454980, New Loss = 0.445921
Saving model and optimizer state at iteration 882 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_882_loss_0.4459.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_882_loss_0.4459.pt
  Validation loss improved! New best: 0.445921. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_882_loss_0.4459.pt
--- Validation Complete ---
--- Epoch: 6 ---
Train Iter: 900 Epoch: 6 [288/2367 (12%)]	Loss: 0.492593	Grad Norm: 0.520768	LR: 5.9E-05	Time: 4.43s/it
Train Iter: 1000 Epoch: 6 [1888/2367 (80%)]	Loss: 0.467497	Grad Norm: 0.467828	LR: 5.9E-05	Time: 5.63s/it
--- Epoch 6 Summary ---
Average Training Loss: 0.497421
Average Grad Norm: 0.957744
Epoch Duration: 636.45s
--- Running Validation at Iteration 1029 ---
Validation Loss: 0.438374 (Duration: 22.66s)
Saving model and optimizer state at iteration 1029 to ./outdir_sweep/eb4c2b2s/checkpoint_1029
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1029
Checking Early Stopping: Current Best Loss = 0.445921, New Loss = 0.438374
Saving model and optimizer state at iteration 1029 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1029_loss_0.4384.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1029_loss_0.4384.pt
  Validation loss improved! New best: 0.438374. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1029_loss_0.4384.pt
--- Validation Complete ---
--- Epoch: 7 ---
Train Iter: 1100 Epoch: 7 [1136/2367 (48%)]	Loss: 0.512880	Grad Norm: 1.606487	LR: 5.9E-05	Time: 4.41s/it
--- Epoch 7 Summary ---
Average Training Loss: 0.490397
Average Grad Norm: 0.924845
Epoch Duration: 640.46s
--- Running Validation at Iteration 1176 ---
Validation Loss: 0.432234 (Duration: 22.66s)
Saving model and optimizer state at iteration 1176 to ./outdir_sweep/eb4c2b2s/checkpoint_1176
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1176
Checking Early Stopping: Current Best Loss = 0.438374, New Loss = 0.432234
Saving model and optimizer state at iteration 1176 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1176_loss_0.4322.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1176_loss_0.4322.pt
  Validation loss improved! New best: 0.432234. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1176_loss_0.4322.pt
--- Validation Complete ---
--- Epoch: 8 ---
Train Iter: 1200 Epoch: 8 [384/2367 (16%)]	Loss: 0.538496	Grad Norm: 0.859799	LR: 5.9E-05	Time: 4.10s/it
Train Iter: 1300 Epoch: 8 [1984/2367 (84%)]	Loss: 0.471754	Grad Norm: 0.526603	LR: 5.9E-05	Time: 4.38s/it
--- Epoch 8 Summary ---
Average Training Loss: 0.475306
Average Grad Norm: 0.733885
Epoch Duration: 651.91s
--- Running Validation at Iteration 1323 ---
Validation Loss: 0.424775 (Duration: 22.68s)
Saving model and optimizer state at iteration 1323 to ./outdir_sweep/eb4c2b2s/checkpoint_1323
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1323
Checking Early Stopping: Current Best Loss = 0.432234, New Loss = 0.424775
Saving model and optimizer state at iteration 1323 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1323_loss_0.4248.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1323_loss_0.4248.pt
  Validation loss improved! New best: 0.424775. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1323_loss_0.4248.pt
--- Validation Complete ---
--- Epoch: 9 ---
Train Iter: 1400 Epoch: 9 [1232/2367 (52%)]	Loss: 0.523525	Grad Norm: 0.560922	LR: 5.9E-05	Time: 3.48s/it
--- Epoch 9 Summary ---
Average Training Loss: 0.472984
Average Grad Norm: 0.822359
Epoch Duration: 643.81s
--- Running Validation at Iteration 1470 ---
Validation Loss: 0.417852 (Duration: 22.64s)
Saving model and optimizer state at iteration 1470 to ./outdir_sweep/eb4c2b2s/checkpoint_1470
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1470
Checking Early Stopping: Current Best Loss = 0.424775, New Loss = 0.417852
Saving model and optimizer state at iteration 1470 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1470_loss_0.4179.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1470_loss_0.4179.pt
  Validation loss improved! New best: 0.417852. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1470_loss_0.4179.pt
--- Validation Complete ---
--- Epoch: 10 ---
Train Iter: 1500 Epoch: 10 [480/2367 (20%)]	Loss: 0.419942	Grad Norm: 0.936777	LR: 5.9E-05	Time: 4.78s/it
Train Iter: 1600 Epoch: 10 [2080/2367 (88%)]	Loss: 0.419765	Grad Norm: 0.454845	LR: 5.9E-05	Time: 3.89s/it
--- Epoch 10 Summary ---
Average Training Loss: 0.472303
Average Grad Norm: 0.780133
Epoch Duration: 638.30s
--- Running Validation at Iteration 1617 ---
Validation Loss: 0.416233 (Duration: 22.70s)
Saving model and optimizer state at iteration 1617 to ./outdir_sweep/eb4c2b2s/checkpoint_1617
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1617
Checking Early Stopping: Current Best Loss = 0.417852, New Loss = 0.416233
Saving model and optimizer state at iteration 1617 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1617_loss_0.4162.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1617_loss_0.4162.pt
  Validation loss improved! New best: 0.416233. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1617_loss_0.4162.pt
--- Validation Complete ---
--- Epoch: 11 ---
Train Iter: 1700 Epoch: 11 [1328/2367 (56%)]	Loss: 0.362015	Grad Norm: 0.472322	LR: 5.9E-05	Time: 5.14s/it
--- Epoch 11 Summary ---
Average Training Loss: 0.470711
Average Grad Norm: 0.762053
Epoch Duration: 634.15s
--- Running Validation at Iteration 1764 ---
Validation Loss: 0.408415 (Duration: 22.51s)
Saving model and optimizer state at iteration 1764 to ./outdir_sweep/eb4c2b2s/checkpoint_1764
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1764
Checking Early Stopping: Current Best Loss = 0.416233, New Loss = 0.408415
Saving model and optimizer state at iteration 1764 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1764_loss_0.4084.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1764_loss_0.4084.pt
  Validation loss improved! New best: 0.408415. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1764_loss_0.4084.pt
--- Validation Complete ---
--- Epoch: 12 ---
Train Iter: 1800 Epoch: 12 [576/2367 (24%)]	Loss: 0.409434	Grad Norm: 0.930245	LR: 5.9E-05	Time: 5.61s/it
Train Iter: 1900 Epoch: 12 [2176/2367 (93%)]	Loss: 0.435795	Grad Norm: 0.602870	LR: 5.9E-05	Time: 4.99s/it
--- Epoch 12 Summary ---
Average Training Loss: 0.453911
Average Grad Norm: 0.849747
Epoch Duration: 647.40s
--- Running Validation at Iteration 1911 ---
Validation Loss: 0.402809 (Duration: 22.57s)
Saving model and optimizer state at iteration 1911 to ./outdir_sweep/eb4c2b2s/checkpoint_1911
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_1911
Checking Early Stopping: Current Best Loss = 0.408415, New Loss = 0.402809
Saving model and optimizer state at iteration 1911 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1911_loss_0.4028.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1911_loss_0.4028.pt
  Validation loss improved! New best: 0.402809. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_1911_loss_0.4028.pt
--- Validation Complete ---
--- Epoch: 13 ---
Train Iter: 2000 Epoch: 13 [1424/2367 (61%)]	Loss: 0.387658	Grad Norm: 0.593125	LR: 5.9E-05	Time: 4.26s/it
--- Epoch 13 Summary ---
Average Training Loss: 0.448121
Average Grad Norm: 0.739208
Epoch Duration: 644.42s
--- Running Validation at Iteration 2058 ---
Validation Loss: 0.397728 (Duration: 22.83s)
Saving model and optimizer state at iteration 2058 to ./outdir_sweep/eb4c2b2s/checkpoint_2058
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2058
Checking Early Stopping: Current Best Loss = 0.402809, New Loss = 0.397728
Saving model and optimizer state at iteration 2058 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2058_loss_0.3977.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2058_loss_0.3977.pt
  Validation loss improved! New best: 0.397728. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2058_loss_0.3977.pt
--- Validation Complete ---
--- Epoch: 14 ---
Train Iter: 2100 Epoch: 14 [672/2367 (29%)]	Loss: 0.438970	Grad Norm: 0.735789	LR: 5.9E-05	Time: 5.08s/it
Train Iter: 2200 Epoch: 14 [2272/2367 (97%)]	Loss: 0.487721	Grad Norm: 0.592215	LR: 5.9E-05	Time: 3.93s/it
--- Epoch 14 Summary ---
Average Training Loss: 0.447229
Average Grad Norm: 0.727735
Epoch Duration: 635.10s
--- Running Validation at Iteration 2205 ---
Validation Loss: 0.395094 (Duration: 22.53s)
Saving model and optimizer state at iteration 2205 to ./outdir_sweep/eb4c2b2s/checkpoint_2205
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2205
Checking Early Stopping: Current Best Loss = 0.397728, New Loss = 0.395094
Saving model and optimizer state at iteration 2205 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2205_loss_0.3951.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2205_loss_0.3951.pt
  Validation loss improved! New best: 0.395094. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2205_loss_0.3951.pt
--- Validation Complete ---
--- Epoch: 15 ---
Train Iter: 2300 Epoch: 15 [1520/2367 (65%)]	Loss: 0.525252	Grad Norm: 0.568362	LR: 5.9E-05	Time: 3.40s/it
--- Epoch 15 Summary ---
Average Training Loss: 0.438248
Average Grad Norm: 0.774001
Epoch Duration: 645.45s
--- Running Validation at Iteration 2352 ---
Validation Loss: 0.393677 (Duration: 22.45s)
Saving model and optimizer state at iteration 2352 to ./outdir_sweep/eb4c2b2s/checkpoint_2352
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2352
Checking Early Stopping: Current Best Loss = 0.395094, New Loss = 0.393677
Saving model and optimizer state at iteration 2352 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2352_loss_0.3937.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2352_loss_0.3937.pt
  Validation loss improved! New best: 0.393677. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2352_loss_0.3937.pt
--- Validation Complete ---
--- Epoch: 16 ---
Train Iter: 2400 Epoch: 16 [768/2367 (33%)]	Loss: 0.490698	Grad Norm: 0.559417	LR: 5.9E-05	Time: 5.00s/it
--- Epoch 16 Summary ---
Average Training Loss: 0.437726
Average Grad Norm: 0.721622
Epoch Duration: 636.82s
--- Running Validation at Iteration 2499 ---
Validation Loss: 0.389528 (Duration: 22.66s)
Saving model and optimizer state at iteration 2499 to ./outdir_sweep/eb4c2b2s/checkpoint_2499
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2499
Checking Early Stopping: Current Best Loss = 0.393677, New Loss = 0.389528
Saving model and optimizer state at iteration 2499 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2499_loss_0.3895.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2499_loss_0.3895.pt
  Validation loss improved! New best: 0.389528. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2499_loss_0.3895.pt
--- Validation Complete ---
--- Epoch: 17 ---
Train Iter: 2500 Epoch: 17 [16/2367 (1%)]	Loss: 0.366957	Grad Norm: 0.366739	LR: 5.9E-05	Time: 4.73s/it
Train Iter: 2600 Epoch: 17 [1616/2367 (69%)]	Loss: 0.444536	Grad Norm: 0.540084	LR: 5.9E-05	Time: 4.30s/it
--- Epoch 17 Summary ---
Average Training Loss: 0.425588
Average Grad Norm: 0.686200
Epoch Duration: 647.94s
--- Running Validation at Iteration 2646 ---
Validation Loss: 0.386323 (Duration: 22.59s)
Saving model and optimizer state at iteration 2646 to ./outdir_sweep/eb4c2b2s/checkpoint_2646
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2646
Checking Early Stopping: Current Best Loss = 0.389528, New Loss = 0.386323
Saving model and optimizer state at iteration 2646 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2646_loss_0.3863.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2646_loss_0.3863.pt
  Validation loss improved! New best: 0.386323. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2646_loss_0.3863.pt
--- Validation Complete ---
--- Epoch: 18 ---
Train Iter: 2700 Epoch: 18 [864/2367 (37%)]	Loss: 0.508716	Grad Norm: 0.711689	LR: 5.9E-05	Time: 4.17s/it
--- Epoch 18 Summary ---
Average Training Loss: 0.427575
Average Grad Norm: 0.766829
Epoch Duration: 636.97s
--- Running Validation at Iteration 2793 ---
Validation Loss: 0.383724 (Duration: 22.73s)
Saving model and optimizer state at iteration 2793 to ./outdir_sweep/eb4c2b2s/checkpoint_2793
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2793
Checking Early Stopping: Current Best Loss = 0.386323, New Loss = 0.383724
Saving model and optimizer state at iteration 2793 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2793_loss_0.3837.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2793_loss_0.3837.pt
  Validation loss improved! New best: 0.383724. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2793_loss_0.3837.pt
--- Validation Complete ---
--- Epoch: 19 ---
Train Iter: 2800 Epoch: 19 [112/2367 (5%)]	Loss: 0.442279	Grad Norm: 0.807384	LR: 5.9E-05	Time: 3.68s/it
Train Iter: 2900 Epoch: 19 [1712/2367 (73%)]	Loss: 0.436272	Grad Norm: 0.565143	LR: 5.9E-05	Time: 4.98s/it
--- Epoch 19 Summary ---
Average Training Loss: 0.417941
Average Grad Norm: 0.813540
Epoch Duration: 644.58s
--- Running Validation at Iteration 2940 ---
Validation Loss: 0.381392 (Duration: 22.67s)
Saving model and optimizer state at iteration 2940 to ./outdir_sweep/eb4c2b2s/checkpoint_2940
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_2940
Checking Early Stopping: Current Best Loss = 0.383724, New Loss = 0.381392
Saving model and optimizer state at iteration 2940 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2940_loss_0.3814.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2940_loss_0.3814.pt
  Validation loss improved! New best: 0.381392. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_2940_loss_0.3814.pt
--- Validation Complete ---
--- Epoch: 20 ---
Train Iter: 3000 Epoch: 20 [960/2367 (41%)]	Loss: 0.504773	Grad Norm: 0.596515	LR: 5.9E-05	Time: 3.48s/it
--- Epoch 20 Summary ---
Average Training Loss: 0.418835
Average Grad Norm: 0.663015
Epoch Duration: 639.66s
--- Running Validation at Iteration 3087 ---
Validation Loss: 0.379569 (Duration: 22.47s)
Saving model and optimizer state at iteration 3087 to ./outdir_sweep/eb4c2b2s/checkpoint_3087
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3087
Checking Early Stopping: Current Best Loss = 0.381392, New Loss = 0.379569
Saving model and optimizer state at iteration 3087 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3087_loss_0.3796.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3087_loss_0.3796.pt
  Validation loss improved! New best: 0.379569. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3087_loss_0.3796.pt
--- Validation Complete ---
--- Epoch: 21 ---
Train Iter: 3100 Epoch: 21 [208/2367 (9%)]	Loss: 0.514162	Grad Norm: 0.615747	LR: 5.9E-05	Time: 3.31s/it
Train Iter: 3200 Epoch: 21 [1808/2367 (77%)]	Loss: 0.436104	Grad Norm: 0.536566	LR: 5.9E-05	Time: 3.63s/it
--- Epoch 21 Summary ---
Average Training Loss: 0.413047
Average Grad Norm: 0.685894
Epoch Duration: 643.02s
--- Running Validation at Iteration 3234 ---
Validation Loss: 0.376843 (Duration: 22.41s)
Saving model and optimizer state at iteration 3234 to ./outdir_sweep/eb4c2b2s/checkpoint_3234
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3234
Checking Early Stopping: Current Best Loss = 0.379569, New Loss = 0.376843
Saving model and optimizer state at iteration 3234 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3234_loss_0.3768.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3234_loss_0.3768.pt
  Validation loss improved! New best: 0.376843. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3234_loss_0.3768.pt
--- Validation Complete ---
--- Epoch: 22 ---
Train Iter: 3300 Epoch: 22 [1056/2367 (45%)]	Loss: 0.426242	Grad Norm: 0.460113	LR: 5.9E-05	Time: 4.62s/it
--- Epoch 22 Summary ---
Average Training Loss: 0.410985
Average Grad Norm: 0.600820
Epoch Duration: 641.51s
--- Running Validation at Iteration 3381 ---
Validation Loss: 0.378092 (Duration: 22.56s)
Saving model and optimizer state at iteration 3381 to ./outdir_sweep/eb4c2b2s/checkpoint_3381
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3381
Checking Early Stopping: Current Best Loss = 0.376843, New Loss = 0.378092
  Validation loss did not improve significantly (1/10).
--- Validation Complete ---
--- Epoch: 23 ---
Train Iter: 3400 Epoch: 23 [304/2367 (13%)]	Loss: 0.344503	Grad Norm: 0.353955	LR: 5.9E-05	Time: 5.19s/it
Train Iter: 3500 Epoch: 23 [1904/2367 (81%)]	Loss: 0.396215	Grad Norm: 0.442622	LR: 5.9E-05	Time: 4.64s/it
--- Epoch 23 Summary ---
Average Training Loss: 0.407324
Average Grad Norm: 1.453739
Epoch Duration: 641.72s
--- Running Validation at Iteration 3528 ---
Validation Loss: 0.378795 (Duration: 22.45s)
Saving model and optimizer state at iteration 3528 to ./outdir_sweep/eb4c2b2s/checkpoint_3528
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3528
Checking Early Stopping: Current Best Loss = 0.376843, New Loss = 0.378795
  Validation loss did not improve significantly (2/10).
--- Validation Complete ---
--- Epoch: 24 ---
Train Iter: 3600 Epoch: 24 [1152/2367 (49%)]	Loss: 0.374090	Grad Norm: 0.341302	LR: 5.9E-05	Time: 4.20s/it
--- Epoch 24 Summary ---
Average Training Loss: 0.398900
Average Grad Norm: 0.593623
Epoch Duration: 651.77s
--- Running Validation at Iteration 3675 ---
Validation Loss: 0.373417 (Duration: 22.64s)
Saving model and optimizer state at iteration 3675 to ./outdir_sweep/eb4c2b2s/checkpoint_3675
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3675
Checking Early Stopping: Current Best Loss = 0.376843, New Loss = 0.373417
Saving model and optimizer state at iteration 3675 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3675_loss_0.3734.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3675_loss_0.3734.pt
  Validation loss improved! New best: 0.373417. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3675_loss_0.3734.pt
--- Validation Complete ---
--- Epoch: 25 ---
Train Iter: 3700 Epoch: 25 [400/2367 (17%)]	Loss: 0.416422	Grad Norm: 0.599040	LR: 5.9E-05	Time: 4.00s/it
Train Iter: 3800 Epoch: 25 [2000/2367 (85%)]	Loss: 0.415159	Grad Norm: 0.728677	LR: 5.9E-05	Time: 4.52s/it
--- Epoch 25 Summary ---
Average Training Loss: 0.405968
Average Grad Norm: 0.677411
Epoch Duration: 640.09s
--- Running Validation at Iteration 3822 ---
Validation Loss: 0.372844 (Duration: 22.79s)
Saving model and optimizer state at iteration 3822 to ./outdir_sweep/eb4c2b2s/checkpoint_3822
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3822
Checking Early Stopping: Current Best Loss = 0.373417, New Loss = 0.372844
Saving model and optimizer state at iteration 3822 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3822_loss_0.3728.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3822_loss_0.3728.pt
  Validation loss improved! New best: 0.372844. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3822_loss_0.3728.pt
--- Validation Complete ---
--- Epoch: 26 ---
Train Iter: 3900 Epoch: 26 [1248/2367 (53%)]	Loss: 0.465571	Grad Norm: 0.637633	LR: 5.9E-05	Time: 3.08s/it
--- Epoch 26 Summary ---
Average Training Loss: 0.399376
Average Grad Norm: 0.627167
Epoch Duration: 643.95s
--- Running Validation at Iteration 3969 ---
Validation Loss: 0.371913 (Duration: 22.86s)
Saving model and optimizer state at iteration 3969 to ./outdir_sweep/eb4c2b2s/checkpoint_3969
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_3969
Checking Early Stopping: Current Best Loss = 0.372844, New Loss = 0.371913
Saving model and optimizer state at iteration 3969 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3969_loss_0.3719.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3969_loss_0.3719.pt
  Validation loss improved! New best: 0.371913. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_3969_loss_0.3719.pt
--- Validation Complete ---
--- Epoch: 27 ---
Train Iter: 4000 Epoch: 27 [496/2367 (21%)]	Loss: 0.394880	Grad Norm: 0.375958	LR: 5.9E-05	Time: 4.87s/it
Train Iter: 4100 Epoch: 27 [2096/2367 (89%)]	Loss: 0.441907	Grad Norm: 0.429295	LR: 5.9E-05	Time: 3.53s/it
--- Epoch 27 Summary ---
Average Training Loss: 0.400596
Average Grad Norm: 0.580474
Epoch Duration: 635.71s
--- Running Validation at Iteration 4116 ---
Validation Loss: 0.369679 (Duration: 22.62s)
Saving model and optimizer state at iteration 4116 to ./outdir_sweep/eb4c2b2s/checkpoint_4116
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4116
Checking Early Stopping: Current Best Loss = 0.371913, New Loss = 0.369679
Saving model and optimizer state at iteration 4116 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_4116_loss_0.3697.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_4116_loss_0.3697.pt
  Validation loss improved! New best: 0.369679. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_4116_loss_0.3697.pt
--- Validation Complete ---
--- Epoch: 28 ---
Train Iter: 4200 Epoch: 28 [1344/2367 (57%)]	Loss: 0.406851	Grad Norm: 0.411750	LR: 5.9E-05	Time: 3.99s/it
--- Epoch 28 Summary ---
Average Training Loss: 0.394058
Average Grad Norm: 0.587569
Epoch Duration: 643.64s
--- Running Validation at Iteration 4263 ---
Validation Loss: 0.370524 (Duration: 22.76s)
Saving model and optimizer state at iteration 4263 to ./outdir_sweep/eb4c2b2s/checkpoint_4263
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4263
Checking Early Stopping: Current Best Loss = 0.369679, New Loss = 0.370524
  Validation loss did not improve significantly (1/10).
--- Validation Complete ---
--- Epoch: 29 ---
Train Iter: 4300 Epoch: 29 [592/2367 (25%)]	Loss: 0.356696	Grad Norm: 0.488716	LR: 5.9E-05	Time: 5.01s/it
Train Iter: 4400 Epoch: 29 [2192/2367 (93%)]	Loss: 0.387787	Grad Norm: 0.489198	LR: 5.9E-05	Time: 4.90s/it
--- Epoch 29 Summary ---
Average Training Loss: 0.389480
Average Grad Norm: 0.537194
Epoch Duration: 647.14s
--- Running Validation at Iteration 4410 ---
Validation Loss: 0.367645 (Duration: 22.58s)
Saving model and optimizer state at iteration 4410 to ./outdir_sweep/eb4c2b2s/checkpoint_4410
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4410
Checking Early Stopping: Current Best Loss = 0.369679, New Loss = 0.367645
Saving model and optimizer state at iteration 4410 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_4410_loss_0.3676.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_4410_loss_0.3676.pt
  Validation loss improved! New best: 0.367645. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_4410_loss_0.3676.pt
--- Validation Complete ---
--- Epoch: 30 ---
Train Iter: 4500 Epoch: 30 [1440/2367 (61%)]	Loss: 0.409587	Grad Norm: 0.513464	LR: 5.9E-05	Time: 4.32s/it
--- Epoch 30 Summary ---
Average Training Loss: 0.388182
Average Grad Norm: 0.581660
Epoch Duration: 645.27s
--- Running Validation at Iteration 4557 ---
Validation Loss: 0.369545 (Duration: 22.41s)
Saving model and optimizer state at iteration 4557 to ./outdir_sweep/eb4c2b2s/checkpoint_4557
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4557
Checking Early Stopping: Current Best Loss = 0.367645, New Loss = 0.369545
  Validation loss did not improve significantly (1/10).
--- Validation Complete ---
--- Epoch: 31 ---
Train Iter: 4600 Epoch: 31 [688/2367 (29%)]	Loss: 0.377491	Grad Norm: 0.626323	LR: 5.9E-05	Time: 4.57s/it
Train Iter: 4700 Epoch: 31 [2288/2367 (97%)]	Loss: 0.331763	Grad Norm: 0.405370	LR: 5.9E-05	Time: 5.10s/it
--- Epoch 31 Summary ---
Average Training Loss: 0.388071
Average Grad Norm: 0.617087
Epoch Duration: 637.17s
--- Running Validation at Iteration 4704 ---
Validation Loss: 0.369679 (Duration: 23.03s)
Saving model and optimizer state at iteration 4704 to ./outdir_sweep/eb4c2b2s/checkpoint_4704
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4704
Checking Early Stopping: Current Best Loss = 0.367645, New Loss = 0.369679
  Validation loss did not improve significantly (2/10).
--- Validation Complete ---
--- Epoch: 32 ---
Train Iter: 4800 Epoch: 32 [1536/2367 (65%)]	Loss: 0.383484	Grad Norm: 0.626365	LR: 5.9E-05	Time: 3.90s/it
--- Epoch 32 Summary ---
Average Training Loss: 0.389754
Average Grad Norm: 0.608080
Epoch Duration: 640.05s
--- Running Validation at Iteration 4851 ---
Validation Loss: 0.369872 (Duration: 22.73s)
Saving model and optimizer state at iteration 4851 to ./outdir_sweep/eb4c2b2s/checkpoint_4851
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4851
Checking Early Stopping: Current Best Loss = 0.367645, New Loss = 0.369872
  Validation loss did not improve significantly (3/10).
--- Validation Complete ---
--- Epoch: 33 ---
Train Iter: 4900 Epoch: 33 [784/2367 (33%)]	Loss: 0.402952	Grad Norm: 0.603093	LR: 5.9E-05	Time: 4.28s/it
--- Epoch 33 Summary ---
Average Training Loss: 0.383949
Average Grad Norm: 0.584050
Epoch Duration: 639.35s
--- Running Validation at Iteration 4998 ---
Validation Loss: 0.368062 (Duration: 22.37s)
Saving model and optimizer state at iteration 4998 to ./outdir_sweep/eb4c2b2s/checkpoint_4998
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_4998
Checking Early Stopping: Current Best Loss = 0.367645, New Loss = 0.368062
  Validation loss did not improve significantly (4/10).
--- Validation Complete ---
--- Epoch: 34 ---
Train Iter: 5000 Epoch: 34 [32/2367 (1%)]	Loss: 0.408616	Grad Norm: 0.736082	LR: 5.9E-05	Time: 3.65s/it
Train Iter: 5100 Epoch: 34 [1632/2367 (69%)]	Loss: 0.436916	Grad Norm: 1.017365	LR: 5.9E-05	Time: 3.21s/it
--- Epoch 34 Summary ---
Average Training Loss: 0.385283
Average Grad Norm: 0.564497
Epoch Duration: 639.56s
--- Running Validation at Iteration 5145 ---
Validation Loss: 0.367435 (Duration: 22.63s)
Saving model and optimizer state at iteration 5145 to ./outdir_sweep/eb4c2b2s/checkpoint_5145
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_5145
Checking Early Stopping: Current Best Loss = 0.367645, New Loss = 0.367435
Saving model and optimizer state at iteration 5145 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5145_loss_0.3674.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5145_loss_0.3674.pt
  Validation loss improved! New best: 0.367435. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5145_loss_0.3674.pt
--- Validation Complete ---
--- Epoch: 35 ---
Train Iter: 5200 Epoch: 35 [880/2367 (37%)]	Loss: 0.335871	Grad Norm: 0.493999	LR: 5.9E-05	Time: 4.99s/it
--- Epoch 35 Summary ---
Average Training Loss: 0.381842
Average Grad Norm: 0.575369
Epoch Duration: 640.32s
--- Running Validation at Iteration 5292 ---
Validation Loss: 0.366415 (Duration: 22.58s)
Saving model and optimizer state at iteration 5292 to ./outdir_sweep/eb4c2b2s/checkpoint_5292
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_5292
Checking Early Stopping: Current Best Loss = 0.367435, New Loss = 0.366415
Saving model and optimizer state at iteration 5292 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5292_loss_0.3664.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5292_loss_0.3664.pt
  Validation loss improved! New best: 0.366415. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5292_loss_0.3664.pt
--- Validation Complete ---
--- Epoch: 36 ---
Train Iter: 5300 Epoch: 36 [128/2367 (5%)]	Loss: 0.355495	Grad Norm: 0.489996	LR: 5.9E-05	Time: 4.38s/it
Train Iter: 5400 Epoch: 36 [1728/2367 (73%)]	Loss: 0.351805	Grad Norm: 0.838892	LR: 5.9E-05	Time: 4.85s/it
--- Epoch 36 Summary ---
Average Training Loss: 0.371850
Average Grad Norm: 0.580210
Epoch Duration: 653.01s
--- Running Validation at Iteration 5439 ---
Validation Loss: 0.364160 (Duration: 22.60s)
Saving model and optimizer state at iteration 5439 to ./outdir_sweep/eb4c2b2s/checkpoint_5439
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_5439
Checking Early Stopping: Current Best Loss = 0.366415, New Loss = 0.364160
Saving model and optimizer state at iteration 5439 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5439_loss_0.3642.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5439_loss_0.3642.pt
  Validation loss improved! New best: 0.364160. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5439_loss_0.3642.pt
--- Validation Complete ---
--- Epoch: 37 ---
Train Iter: 5500 Epoch: 37 [976/2367 (41%)]	Loss: 0.433992	Grad Norm: 1.104501	LR: 5.9E-05	Time: 3.08s/it
--- Epoch 37 Summary ---
Average Training Loss: 0.371091
Average Grad Norm: 0.692840
Epoch Duration: 649.79s
--- Running Validation at Iteration 5586 ---
Validation Loss: 0.363920 (Duration: 22.59s)
Saving model and optimizer state at iteration 5586 to ./outdir_sweep/eb4c2b2s/checkpoint_5586
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_5586
Checking Early Stopping: Current Best Loss = 0.364160, New Loss = 0.363920
Saving model and optimizer state at iteration 5586 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5586_loss_0.3639.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5586_loss_0.3639.pt
  Validation loss improved! New best: 0.363920. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_5586_loss_0.3639.pt
--- Validation Complete ---
--- Epoch: 38 ---
Train Iter: 5600 Epoch: 38 [224/2367 (10%)]	Loss: 0.405293	Grad Norm: 0.549006	LR: 5.9E-05	Time: 3.67s/it
Train Iter: 5700 Epoch: 38 [1824/2367 (78%)]	Loss: 0.366215	Grad Norm: 0.432177	LR: 5.9E-05	Time: 3.98s/it
--- Epoch 38 Summary ---
Average Training Loss: 0.375949
Average Grad Norm: 0.537273
Epoch Duration: 640.40s
--- Running Validation at Iteration 5733 ---
Validation Loss: 0.367452 (Duration: 22.55s)
Saving model and optimizer state at iteration 5733 to ./outdir_sweep/eb4c2b2s/checkpoint_5733
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_5733
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.367452
  Validation loss did not improve significantly (1/10).
--- Validation Complete ---
--- Epoch: 39 ---
Train Iter: 5800 Epoch: 39 [1072/2367 (46%)]	Loss: 0.382323	Grad Norm: 0.420938	LR: 5.9E-05	Time: 5.06s/it
--- Epoch 39 Summary ---
Average Training Loss: 0.372426
Average Grad Norm: 0.573865
Epoch Duration: 640.49s
--- Running Validation at Iteration 5880 ---
Validation Loss: 0.365057 (Duration: 22.76s)
Saving model and optimizer state at iteration 5880 to ./outdir_sweep/eb4c2b2s/checkpoint_5880
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_5880
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.365057
  Validation loss did not improve significantly (2/10).
--- Validation Complete ---
--- Epoch: 40 ---
Train Iter: 5900 Epoch: 40 [320/2367 (14%)]	Loss: 0.326972	Grad Norm: 0.563600	LR: 5.9E-05	Time: 5.70s/it
Train Iter: 6000 Epoch: 40 [1920/2367 (82%)]	Loss: 0.490515	Grad Norm: 0.686532	LR: 5.9E-05	Time: 3.25s/it
--- Epoch 40 Summary ---
Average Training Loss: 0.372566
Average Grad Norm: 0.559122
Epoch Duration: 640.98s
--- Running Validation at Iteration 6027 ---
Validation Loss: 0.366644 (Duration: 22.60s)
Saving model and optimizer state at iteration 6027 to ./outdir_sweep/eb4c2b2s/checkpoint_6027
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6027
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.366644
  Validation loss did not improve significantly (3/10).
--- Validation Complete ---
--- Epoch: 41 ---
Train Iter: 6100 Epoch: 41 [1168/2367 (50%)]	Loss: 0.278105	Grad Norm: 0.473899	LR: 5.9E-05	Time: 5.31s/it
--- Epoch 41 Summary ---
Average Training Loss: 0.372582
Average Grad Norm: 0.525819
Epoch Duration: 636.82s
--- Running Validation at Iteration 6174 ---
Validation Loss: 0.364161 (Duration: 22.67s)
Saving model and optimizer state at iteration 6174 to ./outdir_sweep/eb4c2b2s/checkpoint_6174
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6174
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.364161
  Validation loss did not improve significantly (4/10).
--- Validation Complete ---
--- Epoch: 42 ---
Train Iter: 6200 Epoch: 42 [416/2367 (18%)]	Loss: 0.459289	Grad Norm: 0.543993	LR: 5.9E-05	Time: 3.79s/it
Train Iter: 6300 Epoch: 42 [2016/2367 (86%)]	Loss: 0.363481	Grad Norm: 0.499826	LR: 5.9E-05	Time: 4.54s/it
--- Epoch 42 Summary ---
Average Training Loss: 0.373422
Average Grad Norm: 0.568763
Epoch Duration: 637.08s
--- Running Validation at Iteration 6321 ---
Validation Loss: 0.366697 (Duration: 22.55s)
Saving model and optimizer state at iteration 6321 to ./outdir_sweep/eb4c2b2s/checkpoint_6321
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6321
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.366697
  Validation loss did not improve significantly (5/10).
--- Validation Complete ---
--- Epoch: 43 ---
Train Iter: 6400 Epoch: 43 [1264/2367 (54%)]	Loss: 0.389114	Grad Norm: 0.599047	LR: 5.9E-05	Time: 4.39s/it
--- Epoch 43 Summary ---
Average Training Loss: 0.362654
Average Grad Norm: 0.533741
Epoch Duration: 650.10s
--- Running Validation at Iteration 6468 ---
Validation Loss: 0.365287 (Duration: 22.51s)
Saving model and optimizer state at iteration 6468 to ./outdir_sweep/eb4c2b2s/checkpoint_6468
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6468
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.365287
  Validation loss did not improve significantly (6/10).
--- Validation Complete ---
--- Epoch: 44 ---
Train Iter: 6500 Epoch: 44 [512/2367 (22%)]	Loss: 0.330656	Grad Norm: 0.559346	LR: 5.9E-05	Time: 4.61s/it
Train Iter: 6600 Epoch: 44 [2112/2367 (90%)]	Loss: 0.319833	Grad Norm: 0.339705	LR: 5.9E-05	Time: 5.41s/it
--- Epoch 44 Summary ---
Average Training Loss: 0.368968
Average Grad Norm: 0.548782
Epoch Duration: 639.62s
--- Running Validation at Iteration 6615 ---
Validation Loss: 0.363777 (Duration: 22.52s)
Saving model and optimizer state at iteration 6615 to ./outdir_sweep/eb4c2b2s/checkpoint_6615
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6615
Checking Early Stopping: Current Best Loss = 0.363920, New Loss = 0.363777
Saving model and optimizer state at iteration 6615 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_6615_loss_0.3638.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_6615_loss_0.3638.pt
  Validation loss improved! New best: 0.363777. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_6615_loss_0.3638.pt
--- Validation Complete ---
--- Epoch: 45 ---
Train Iter: 6700 Epoch: 45 [1360/2367 (58%)]	Loss: 0.295667	Grad Norm: 0.341887	LR: 5.9E-05	Time: 4.87s/it
--- Epoch 45 Summary ---
Average Training Loss: 0.362637
Average Grad Norm: 0.469958
Epoch Duration: 645.00s
--- Running Validation at Iteration 6762 ---
Validation Loss: 0.365818 (Duration: 22.56s)
Saving model and optimizer state at iteration 6762 to ./outdir_sweep/eb4c2b2s/checkpoint_6762
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6762
Checking Early Stopping: Current Best Loss = 0.363777, New Loss = 0.365818
  Validation loss did not improve significantly (1/10).
--- Validation Complete ---
--- Epoch: 46 ---
Train Iter: 6800 Epoch: 46 [608/2367 (26%)]	Loss: 0.324848	Grad Norm: 0.588549	LR: 5.9E-05	Time: 4.87s/it
Train Iter: 6900 Epoch: 46 [2208/2367 (94%)]	Loss: 0.410563	Grad Norm: 0.413549	LR: 5.9E-05	Time: 4.18s/it
--- Epoch 46 Summary ---
Average Training Loss: 0.362664
Average Grad Norm: 0.534352
Epoch Duration: 641.06s
--- Running Validation at Iteration 6909 ---
Validation Loss: 0.365606 (Duration: 22.68s)
Saving model and optimizer state at iteration 6909 to ./outdir_sweep/eb4c2b2s/checkpoint_6909
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_6909
Checking Early Stopping: Current Best Loss = 0.363777, New Loss = 0.365606
  Validation loss did not improve significantly (2/10).
--- Validation Complete ---
--- Epoch: 47 ---
Train Iter: 7000 Epoch: 47 [1456/2367 (62%)]	Loss: 0.365459	Grad Norm: 0.492592	LR: 5.9E-05	Time: 4.23s/it
--- Epoch 47 Summary ---
Average Training Loss: 0.363740
Average Grad Norm: 0.539887
Epoch Duration: 636.36s
--- Running Validation at Iteration 7056 ---
Validation Loss: 0.365648 (Duration: 22.71s)
Saving model and optimizer state at iteration 7056 to ./outdir_sweep/eb4c2b2s/checkpoint_7056
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7056
Checking Early Stopping: Current Best Loss = 0.363777, New Loss = 0.365648
  Validation loss did not improve significantly (3/10).
--- Validation Complete ---
--- Epoch: 48 ---
Train Iter: 7100 Epoch: 48 [704/2367 (30%)]	Loss: 0.354072	Grad Norm: 0.492658	LR: 5.9E-05	Time: 4.21s/it
Train Iter: 7200 Epoch: 48 [2304/2367 (98%)]	Loss: 0.271156	Grad Norm: 0.336359	LR: 5.9E-05	Time: 5.19s/it
--- Epoch 48 Summary ---
Average Training Loss: 0.361226
Average Grad Norm: 0.515972
Epoch Duration: 642.37s
--- Running Validation at Iteration 7203 ---
Validation Loss: 0.364410 (Duration: 22.82s)
Saving model and optimizer state at iteration 7203 to ./outdir_sweep/eb4c2b2s/checkpoint_7203
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7203
Checking Early Stopping: Current Best Loss = 0.363777, New Loss = 0.364410
  Validation loss did not improve significantly (4/10).
--- Validation Complete ---
--- Epoch: 49 ---
Train Iter: 7300 Epoch: 49 [1552/2367 (66%)]	Loss: 0.329859	Grad Norm: 0.603827	LR: 5.9E-05	Time: 5.27s/it
--- Epoch 49 Summary ---
Average Training Loss: 0.356996
Average Grad Norm: 0.466637
Epoch Duration: 643.19s
--- Running Validation at Iteration 7350 ---
Validation Loss: 0.363274 (Duration: 22.58s)
Saving model and optimizer state at iteration 7350 to ./outdir_sweep/eb4c2b2s/checkpoint_7350
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7350
Checking Early Stopping: Current Best Loss = 0.363777, New Loss = 0.363274
Saving model and optimizer state at iteration 7350 to ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_7350_loss_0.3633.pt
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_7350_loss_0.3633.pt
  Validation loss improved! New best: 0.363274. Saved best model: ./outdir_sweep/eb4c2b2s/checkpoint_best_iter_7350_loss_0.3633.pt
--- Validation Complete ---
--- Epoch: 50 ---
Train Iter: 7400 Epoch: 50 [800/2367 (34%)]	Loss: 0.419196	Grad Norm: 0.579126	LR: 5.9E-05	Time: 3.53s/it
--- Epoch 50 Summary ---
Average Training Loss: 0.355860
Average Grad Norm: 0.539865
Epoch Duration: 644.47s
--- Running Validation at Iteration 7497 ---
Validation Loss: 0.364968 (Duration: 22.68s)
Saving model and optimizer state at iteration 7497 to ./outdir_sweep/eb4c2b2s/checkpoint_7497
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7497
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.364968
  Validation loss did not improve significantly (1/10).
--- Validation Complete ---
--- Epoch: 51 ---
Train Iter: 7500 Epoch: 51 [48/2367 (2%)]	Loss: 0.358025	Grad Norm: 0.530943	LR: 5.9E-05	Time: 3.90s/it
Train Iter: 7600 Epoch: 51 [1648/2367 (70%)]	Loss: 0.333582	Grad Norm: 0.340452	LR: 5.9E-05	Time: 4.27s/it
--- Epoch 51 Summary ---
Average Training Loss: 0.355249
Average Grad Norm: 0.480922
Epoch Duration: 642.99s
--- Running Validation at Iteration 7644 ---
Validation Loss: 0.364754 (Duration: 22.52s)
Saving model and optimizer state at iteration 7644 to ./outdir_sweep/eb4c2b2s/checkpoint_7644
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7644
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.364754
  Validation loss did not improve significantly (2/10).
--- Validation Complete ---
--- Epoch: 52 ---
Train Iter: 7700 Epoch: 52 [896/2367 (38%)]	Loss: 0.317154	Grad Norm: 0.401200	LR: 5.9E-05	Time: 4.43s/it
--- Epoch 52 Summary ---
Average Training Loss: 0.352565
Average Grad Norm: 0.494006
Epoch Duration: 643.44s
--- Running Validation at Iteration 7791 ---
Validation Loss: 0.365538 (Duration: 22.71s)
Saving model and optimizer state at iteration 7791 to ./outdir_sweep/eb4c2b2s/checkpoint_7791
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7791
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.365538
  Validation loss did not improve significantly (3/10).
--- Validation Complete ---
--- Epoch: 53 ---
Train Iter: 7800 Epoch: 53 [144/2367 (6%)]	Loss: 0.349321	Grad Norm: 0.363402	LR: 5.9E-05	Time: 4.64s/it
Train Iter: 7900 Epoch: 53 [1744/2367 (74%)]	Loss: 0.349066	Grad Norm: 0.401050	LR: 5.9E-05	Time: 3.71s/it
--- Epoch 53 Summary ---
Average Training Loss: 0.351867
Average Grad Norm: 0.519612
Epoch Duration: 648.02s
--- Running Validation at Iteration 7938 ---
Validation Loss: 0.364899 (Duration: 22.72s)
Saving model and optimizer state at iteration 7938 to ./outdir_sweep/eb4c2b2s/checkpoint_7938
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_7938
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.364899
  Validation loss did not improve significantly (4/10).
--- Validation Complete ---
--- Epoch: 54 ---
Train Iter: 8000 Epoch: 54 [992/2367 (42%)]	Loss: 0.350479	Grad Norm: 0.629990	LR: 5.9E-05	Time: 4.24s/it
--- Epoch 54 Summary ---
Average Training Loss: 0.356789
Average Grad Norm: 0.511819
Epoch Duration: 639.76s
--- Running Validation at Iteration 8085 ---
Validation Loss: 0.365902 (Duration: 22.54s)
Saving model and optimizer state at iteration 8085 to ./outdir_sweep/eb4c2b2s/checkpoint_8085
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_8085
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.365902
  Validation loss did not improve significantly (5/10).
--- Validation Complete ---
--- Epoch: 55 ---
Train Iter: 8100 Epoch: 55 [240/2367 (10%)]	Loss: 0.346639	Grad Norm: 0.401349	LR: 5.9E-05	Time: 4.11s/it
Train Iter: 8200 Epoch: 55 [1840/2367 (78%)]	Loss: 0.250073	Grad Norm: 0.301226	LR: 5.9E-05	Time: 5.29s/it
--- Epoch 55 Summary ---
Average Training Loss: 0.352177
Average Grad Norm: 0.510452
Epoch Duration: 640.21s
--- Running Validation at Iteration 8232 ---
Validation Loss: 0.364904 (Duration: 22.55s)
Saving model and optimizer state at iteration 8232 to ./outdir_sweep/eb4c2b2s/checkpoint_8232
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_8232
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.364904
  Validation loss did not improve significantly (6/10).
--- Validation Complete ---
--- Epoch: 56 ---
Train Iter: 8300 Epoch: 56 [1088/2367 (46%)]	Loss: 0.293172	Grad Norm: 0.449050	LR: 5.9E-05	Time: 4.92s/it
--- Epoch 56 Summary ---
Average Training Loss: 0.354755
Average Grad Norm: 0.587567
Epoch Duration: 635.48s
--- Running Validation at Iteration 8379 ---
Validation Loss: 0.365775 (Duration: 22.96s)
Saving model and optimizer state at iteration 8379 to ./outdir_sweep/eb4c2b2s/checkpoint_8379
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_8379
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.365775
  Validation loss did not improve significantly (7/10).
--- Validation Complete ---
--- Epoch: 57 ---
Train Iter: 8400 Epoch: 57 [336/2367 (14%)]	Loss: 0.412277	Grad Norm: 0.471908	LR: 5.9E-05	Time: 4.01s/it
Train Iter: 8500 Epoch: 57 [1936/2367 (82%)]	Loss: 0.425621	Grad Norm: 0.447276	LR: 5.9E-05	Time: 3.85s/it
--- Epoch 57 Summary ---
Average Training Loss: 0.345515
Average Grad Norm: 0.466334
Epoch Duration: 647.42s
--- Running Validation at Iteration 8526 ---
Validation Loss: 0.365789 (Duration: 22.59s)
Saving model and optimizer state at iteration 8526 to ./outdir_sweep/eb4c2b2s/checkpoint_8526
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_8526
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.365789
  Validation loss did not improve significantly (8/10).
--- Validation Complete ---
--- Epoch: 58 ---
Train Iter: 8600 Epoch: 58 [1184/2367 (50%)]	Loss: 0.287539	Grad Norm: 0.279926	LR: 5.9E-05	Time: 5.32s/it
--- Epoch 58 Summary ---
Average Training Loss: 0.347214
Average Grad Norm: 0.474410
Epoch Duration: 645.74s
--- Running Validation at Iteration 8673 ---
Validation Loss: 0.364936 (Duration: 22.66s)
Saving model and optimizer state at iteration 8673 to ./outdir_sweep/eb4c2b2s/checkpoint_8673
Checkpoint saved: ./outdir_sweep/eb4c2b2s/checkpoint_8673
Checking Early Stopping: Current Best Loss = 0.363274, New Loss = 0.364936
  Validation loss did not improve significantly (9/10).
--- Validation Complete ---
--- Epoch: 59 ---
Train Iter: 8700 Epoch: 59 [432/2367 (18%)]	Loss: 0.432629	Grad Norm: 0.512250	LR: 5.9E-05	Time: 3.93s/it
Train Iter: 8800 Epoch: 59 [2032/2367 (86%)]	Loss: 0.339682	Grad Norm: 0.554128	LR: 5.9E-05	Time: 4.39s/it
--- Epoch 59 Summary ---
Average Training Loss: 0.346173
Average Grad Norm: 0.447986
Epoch Duration: 641.59s
--- Running Validation at Iteration 8820 ---